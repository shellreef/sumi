#include <iostream>

char to_base64_set[] =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
char from_base64_set[] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // 00-0f
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // 10-1f
    0, 0,62, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,63,    // 20-2f
   52,53,54,55,56,57,58,59,60,61, 0, 0, 0, 0, 0, 0,    // 30-3f
    0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,13,14,    // 40-4f
   15,16,17,18,19,20,21,22,23,24,25, 0, 0, 0, 0, 0,    // 50-5f
    0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,    // 60-6f
   41,42,43,44,45,46,47,48,49,50,51, 0, 0, 0, 0, 0,    // 70-7f
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // 80-8f
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // 90-9f
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // a0-af
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // b0-bf
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // c0-cf
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // d0-df
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // e0-ef
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,    // f0-ff
};

int main()
{
char in[3];
char ot[4];
char de[3];

in[0] = '\x20';
in[1] = '\x30';
in[2] = '\x40';

// 6-bit groups
ot[0] = to_base64_set[in[0] >> 2];
ot[1] = to_base64_set[((in[0] & 3) << 4) | ((in[1] & 0xf0) >> 4)];
ot[2] = to_base64_set[(in[1] & 0xf) << 2 | ((in[2] & 0xc0) >> 6)];
ot[3] = to_base64_set[in[2] & 0x3f];

std::cout << ot[0] << ot[1] << ot[2] << ot[3] << std::endl;

ot[0] = from_base64_set[ot[0]];
ot[1] = from_base64_set[ot[1]];
ot[2] = from_base64_set[ot[2]];
ot[3] = from_base64_set[ot[3]];

de[0] = (ot[0] << 2) | ((ot[1] & 0x30) >> 4);
de[1] = (ot[1] << 4) | ((ot[2] & 0x3c) >> 2);
de[2] = (ot[2] << 6) | ot[3];

std::cout << de[0] << de[1] << de[2] << std::endl;
return 0;
}
